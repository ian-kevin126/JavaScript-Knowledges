const maxSumDivThree = nums => {
  let ret = 0;
  let mod1 = [];
  let mod2 = [];
  for (let i = 0; i < nums.length; ++i) {
    ret += nums[i];
    nums[i] % 3 === 1 && mod1.push(nums[i]);
    nums[i] % 3 === 2 && mod2.push(nums[i]);
  }
  let l1 = mod1.length - 1;
  let l2 = mod2.length - 1;
  mod1.sort((a, b) => b - a);
  mod2.sort((a, b) => b - a);
  while (l1 !== l2 && (l1 - l2) % 3 !== 0) {
    if (l1 === -1) {
      ret -= mod2[l2--];
    } else if (l2 === -1) {
      ret -= mod1[l1--];
    } else {
      ret -= mod1[l1] < mod2[l2] ? mod1[l1--] : mod2[l2--];
    }
  }
  return ret;
};

[
  [3,6,5,1,8],
  [4],
  [1,2,3,4,4],
  [121, 103, 100, 94, 91, 263, 191, 14, 8],
  [366,809,6,792,822,181,210,588,344,618,341,410,121,864,191,749,637,169,123,472,358,908,235,914,322,946,738,754,908,272,267,326,587,267,803,281,586,707,94,627,724,469,568,57,103,984,787,552,14,545,866,494,263,157,479,823,835,100,495,773,729,921,348,871,91,386,183,979,716,806,639,290,612,322,289,910,484,300,195,546,499,213,8,623,490,473,603,721,793,418,551,331,598,670,960,483,154,317,834,352]
].forEach(data => {
  console.log(maxSumDivThree(data));
});
